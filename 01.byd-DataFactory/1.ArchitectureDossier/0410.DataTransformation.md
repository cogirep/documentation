# Système de transformation

Les transformations font partie de la famille **System of Insight**. Une transformation permet de produire une donnée de type Y à partir d'une donnée de type X. 


### Anatomie d'une transformation

Une transformation est un **microservice** autonome pouvant être déclenché par : 
 
  * Un appel HTTP

Ce microservice représente un noeud de transformation de l'ensemble des transformations disponible sur la plateforme.
Un noeud de transformation peut executer un seul  

Une transformation traite une tâche d'une façon asynchrone. L'appel permets de poster une tâche dans la file d'attente interne au **noeud** de transformation. 
Les tâches sont ensuite traités dans leurs ordre d'arrivée dans le noeud de transformation (**FIFO - First In First Out**).  

Les consommateurs (**Apps Beyond**) appellent une transformation avec un ensemble d'informations décrivant: 

  * La localisation du fichier source de transformation
  * La destination ou seront placés le/les fichier(s) résultant(s)
  * Accéssoirement des paramétres spécifique à la transformation

 Plus techniquement, l'objet source d'une transformation doit au moins contenir:   

  * **srcBucket***: Le bucket contenant le fichier source
  * **srcFile***: Le chemin du fichier source
  * **destBucket***: Le bucket destination où le fichier résultat de transformation sera enregistré
  * **opts**: Optionnel, un ensemble d'options/arguments pour enrichir le process d'une transformation 
  * **weight**: Optionnel, pour de future besoins, le degré de priorité d'une transformation pour la gestion de file d'attente.

Les fichiers manipulés par un noeud de transformation sont enregistré sur un bucket **COS**.


![Architecture : vue d'ensemble](./images/0410.TransformationComponentOverview.png)

### Distribution des noeuds de transformation

Les noeuds de transformations sont gérés d'une façon complétement distribués permettant une isolation entre les noeuds de transformations permettant ainsi une gestion plus simple et efficace des échecs ainsi que des mise à jour des transformations :

  * Les noeuds d'une transformation sont taggés par type pour permettre un load-blancing sur un même type de tranformation.

  * Chaque type de transformation à un load-balancer permettant de cibler les requêtes sur un seul type de transformation. 

  * Un load-balancer global est placé au plus haut niveau pour permettre la redirection vers le load-balancer de la transformation désiré suivant un chemin (based path routing).

